<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta http-equiv="Content-Language" content="en" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="WWW::AdventCalendar v1.113" />
    <link rel="alternate" title="Perl Advent Calendar 2017 XML feed" href="atom.xml" type="application/atom+xml" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <link rel="stylesheet" href="2017.css" type="text/css" />
    <title>
Perl Advent Calendar 2017 - 
Around the world with Emoji

</title>
</head>
<body>
    <div id="contentwrapper">
        <div id="header">
            <h1><a href="index.html">Perl Advent Calendar 2017</a></h1>
        </div>

        <p id="tagline">2017 twenty four merry days of Perl
         <a class='feed' href="atom.xml">Feed</a>
        </p>

        <div id="content">
          

<h1 class='title'>Around the world with Emoji</h1>
<div class='subtitle'>Emoji::NationalFlag - 2017-12-02</div>

<div class='pod'><p>It was the night before the night before Christmas and, as one of the best programmers on the rapid response team, Sherry Silversparkles was in a rush. She&#39;d been handed the task of automating the updating of Santa&#39;s twitter account as he travelled around the world. The kind of updates she&#39;d been asked to post were really simple, as was the code she&#39;d hastily written to do so.</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;<br />3:&nbsp;<br />4:&nbsp;<br />5:&nbsp;<br />6:&nbsp;<br />7:&nbsp;<br />8:&nbsp;<br />9:&nbsp;<br />10:&nbsp;<br />11:&nbsp;<br />12:&nbsp;<br />13:&nbsp;<br />14:&nbsp;<br />15:&nbsp;<br />16:&nbsp;<br />17:&nbsp;<br />18:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="keyword">use</span> <span class="word">Net::Twitter</span><span class="structure">;</span><br /><span class="keyword">use</span> <span class="word">Country::Codes</span> <span class="words">qw( country )</span><span class="structure">;</span><br /><br /><span class="keyword">sub</span> <span class="word">tweet</span> <span class="structure">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$country_code</span> <span class="operator">=</span> <span class="core">shift</span><span class="structure">;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$country</span> <span class="operator">=</span> <span class="word">country</span><span class="structure">(</span><span class="symbol">$country_code</span><span class="structure">)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">or</span> <span class="word">die</span> <span class="double">&quot;Unknown country!&quot;</span><span class="structure">;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$twitter</span> <span class="operator">=</span> <span class="word">Net::Twitter</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">username</span> <span class="operator">=&gt;</span> <span class="symbol">$user</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">password</span> <span class="operator">=&gt;</span> <span class="symbol">$pass</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">source</span>   <span class="operator">=&gt;</span> <span class="single">'Santa Twitteromatic Two Thousand'</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$twitter</span><span class="operator">-&gt;</span><span class="word">update</span><span class="structure">(</span><span class="double">&quot;Father Christmas's sleigh is flying to $country&quot;</span><span class="structure">);</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span class="structure">;</span><br /><span class="structure">}</span></code><br />&nbsp;</td></table>

<p>She submitted her work for acceptance by Elf command. However, within minutes she&#39;d got a report back on the contents of her messages: tl;dr. Apparently today&#39;s youths wouldn&#39;t read more than a couple of words before getting bored and going back to checking Instagram. Elf command had suggested a three glyph alternative message:</p>

<center><font size="48">&#127877;&rarr;&#127482;&#127480;</font></center>

<p>&quot;Nothing like changing the specs at the last minute&quot; Sherry mused to herself. Now she&#39;d have to work out how to do these changes in a jiffy! Sherry already knew how to render the emoji for Santa and that right arrow:</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="word">print</span> <span class="double">&quot;\N{FATHER CHRISTMAS}\N{RIGHTWARDS ARROW}&quot;</span><span class="structure">;</span></code><br />&nbsp;</td></table>

<p>But as hard as she looked in her unicode charts, she couldn&#39;t find the character for the US flag, nor for any of the other countries.</p>

<p>After much head scratching, and a relaxing glass of mulled wine, Sherry discovered that not all glyphs in Unicode are represented by a single character. Some glyphs are made up by combining one or more characters:</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="word">print</span> <span class="double">&quot;\N{REGIONAL INDICATOR SYMBOL LETTER U}&quot;</span><span class="structure">;</span><br /><span class="word">print</span> <span class="double">&quot;\N{REGIONAL INDICATOR SYMBOL LETTER S}&quot;</span><span class="structure">;</span></code><br />&nbsp;</td></table>

<p>On systems that don&#39;t understand how to render flags that would simply display as an odd looking <code>U</code> followed by an odd looking <code>S</code> (which hopefully the end user would know as the ISO 3166-1 code for the United States). On more capable systems that would be turned into a United States flag emoji.</p>

<p>So, that was simple - sort of - but Sherry still needed some way to turn the country code that her subroutine was being passed into those corresponding regional indicator characters. Of course, this being Perl, there was a module for that on the CPAN:</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;<br />3:&nbsp;<br />4:&nbsp;<br />5:&nbsp;<br />6:&nbsp;<br />7:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="keyword">use</span> <span class="word">Emoji::NationalFlag</span> <span class="words">qw( code2flag )</span><span class="structure">;</span><br /><br /><span class="operator">...</span><br /><br /><span class="symbol">$twitter</span><span class="operator">-&gt;</span><span class="word">update</span><span class="structure">(</span><br />&nbsp;&nbsp;&nbsp;<span class="double">&quot;\N{FATHER CHRISTMAS}\N{RIGHTWARDS ARROW}&quot;</span> <span class="operator">.</span> <span class="word">code2flag</span><span class="structure">(</span> <span class="symbol">$country_code</span> <span class="structure">)</span><br /><span class="structure">);</span></code><br />&nbsp;</td></table>

<p>This time Sherry&#39;s changes were accepted, leaving her free to move onto the next last-minute Christmas programming panic...</p>

</div>

<div id='author'>
<img alt='Gravatar Image' style='vertical-align:middle' src=http://www.gravatar.com/avatar/5d71b5f0c61e97cd452d625cc24a4c82?r=g&s=80&d=retro />
This article contributed by: Mark Fowler &lt;mark@twoshortplanks.com&gt;
</div>


<ul id="pager">
    <li class="previous"><a title="Emoji" href="2017-12-01.html">Previous</a></li>

    <li class="next"><a title="Context Matters" href="2017-12-03.html">Next</a></li>
</ul>
<div style="clear: both"></div>

        </div>

    </div>



<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-27056407-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>





